<?php 
defined('BASEPATH') OR exit('No direct script access allowed');?>
<!DOCTYPE html>
<html lang="en">
<body>
	<div class="wrapper hp_1">
        <?php if (!isset($_SESSION['login'])) : ?>
            <section class="banner-section">
                <div class="container">
                    <div class="banner-text">
                        <h2>Watch share and upload with friends</h2>
                        <a href="user/go_to_signup_page" title="">Create my account</a>
                    </div><!--banner-text end-->
                    <h3 class="headline">Video of the Day by <a href="#" title="">newfox media</a></h3>
                </div>
            </section><!--banner-section end-->
        <?php endif; ?>
		<section class="vds-main">
			<div class="vidz-row">
				<div class="container">
					<div class="vidz_sec">
						<h3>Featured Videos</h3>
						<div class="vidz_list">
							<div class="row">
								<div class="col-lg-3 col-md-6 col-sm-6 col-6 full_wdth">
									<div class="videoo">
										<div class="vid_thumbainl">
											<a href="single_video_page.html" title="">
												<img src="/oren/images/resources/vide1.png" alt="">
												<span class="vid-time">10:21</span>
												<span class="watch_later">
													<i class="icon-watch_later_fill"></i>
												</span>
											</a>	
										</div><!--vid_thumbnail end-->
										<div class="video_info">
											<h3><a href="single_video_page.html" title="">Kingdom Come: Deliverance Funny Moments and Fails</a></h3>
											<h4><a href="Single_Channel_Home.html" title="">newfox media</a> <span class="verify_ic"><i class="icon-tick"></i></span></h4>
											<span>686K views .<small class="posted_dt">1 week ago</small></span>
										</div>
									</div><!--videoo end-->
								</div>
								<div class="col-lg-3 col-md-6 col-sm-6 col-6 full_wdth">
									<div class="videoo">
										<div class="vid_thumbainl">
											<a href="single_video_page.html" title="">
												<img src="/oren/images/resources/vide2.png" alt="">
												<span class="vid-time">13:49</span>
												<span class="watch_later">
													<i class="icon-watch_later_fill"></i>
												</span>
											</a>	
										</div><!--vid_thumbnail end-->
										<div class="video_info">
											<h3><a href="single_video_page.html" title="">DR DISRESPECT - Before They Were Famous - Twitch Streamer</a></h3>
											<h4><a href="Single_Channel_Home.html" title="">Eros Now</a> </h4>
											<span>283K views .<small class="posted_dt">3 months ago</small></span>
										</div>
									</div><!--videoo end-->
								</div>
								<div class="col-lg-3 col-md-6 col-sm-6 col-6 full_wdth">
									<div class="videoo">
										<div class="vid_thumbainl">
											<a href="single_video_page.html" title="">
												<img src="/oren/images/resources/vide3.png" alt="">
												<span class="vid-time">2:54</span>
												<span class="watch_later">
													<i class="icon-watch_later_fill"></i>
												</span>
											</a>	
										</div><!--vid_thumbnail end-->
										<div class="video_info">
											<h3><a href="single_video_page.html" title="">Top Perectly Timed Twitch Moments 2017 #7</a></h3>
											<h4><a href="Single_Channel_Home.html" title="">Animal Planet</a> <span class="verify_ic"><i class="icon-tick"></i></span></h4>
											<span>2.6M views .<small class="posted_dt">2 months ago</small></span>
										</div>
									</div><!--videoo end-->
								</div>
								<div class="col-lg-3 col-md-6 col-sm-6 col-6 full_wdth">
									<div class="videoo">
										<div class="vid_thumbainl">
											<a href="single_video_page.html" title="">
												<img src="/oren/images/resources/vide4.png" alt="">
												<span class="vid-time">5:25</span>
												<span class="watch_later">
													<i class="icon-watch_later_fill"></i>
												</span>
											</a>	
										</div><!--vid_thumbnail end-->
										<div class="video_info">
											<h3><a href="single_video_page.html" title="">Top 5 Amazing Bridge Block ever in PUBG</a></h3>
											<h4><a href="Single_Channel_Home.html" title="">Maketzi</a> </h4>
											<span>612K views .<small class="posted_dt">5 months ago</small></span>
										</div>
									</div><!--videoo end-->
								</div>
								<div class="col-lg-3 col-md-6 col-sm-6 col-6 full_wdth">
									<div class="videoo">
										<div class="vid_thumbainl">
											<a href="single_video_page.html" title="">
												<img src="/oren/images/resources/vide5.png" alt="">
												<span class="vid-time">4:01</span>
												<span class="watch_later">
													<i class="icon-watch_later_fill"></i>
												</span>
											</a>	
										</div><!--vid_thumbnail end-->
										<div class="video_info">
											<h3><a href="single_video_page.html" title="">Trailer Park Boys Season 12 - Official Trailer</a></h3>
											<h4><a href="Single_Channel_Home.html" title="">ScereBro</a> </h4>
											<span>45K views .<small class="posted_dt">3 days ago</small></span>
										</div>
									</div><!--videoo end-->
								</div>
								<div class="col-lg-3 col-md-6 col-sm-6 col-6 full_wdth">
									<div class="videoo">
										<div class="vid_thumbainl">
											<a href="single_video_page.html" title="">
												<img src="/oren/images/resources/vide6.png" alt="">
												<span class="vid-time">6:20</span>
												<span class="watch_later">
													<i class="icon-watch_later_fill"></i>
												</span>
											</a>	
										</div><!--vid_thumbnail end-->
										<div class="video_info">
											<h3><a href="single_video_page.html" title="">A day in the life of a Google software engineer</a></h3>
											<h4><a href="Single_Channel_Home.html" title="">MathChief</a> </h4>
											<span>86K views .<small class="posted_dt">6 days ago</small></span>
										</div>
									</div><!--videoo end-->
								</div>
								<div class="col-lg-3 col-md-6 col-sm-6 col-6 full_wdth">
									<div class="videoo">
										<div class="vid_thumbainl">
											<a href="single_video_page.html" title="">
												<img src="/oren/images/resources/vide7.png" alt="">
												<span class="vid-time">8:16</span>
												<span class="watch_later">
													<i class="icon-watch_later_fill"></i>
												</span>
											</a>	
										</div><!--vid_thumbnail end-->
										<div class="video_info">
											<h3><a href="single_video_page.html" title="">Avengers: Infinity War - Gym Workout motivation 2019</a></h3>
											<h4><a href="Single_Channel_Home.html" title="">RealLifeLore</a> <span class="verify_ic"><i class="icon-tick"></i></span></h4>
											<span>144K views .<small class="posted_dt">6 days ago</small></span>
										</div>
									</div><!--videoo end-->
								</div>
								<div class="col-lg-3 col-md-6 col-sm-6 col-6 full_wdth">
									<div class="videoo">
										<div class="vid_thumbainl">
											<a href="single_video_page.html" title="">
												<img src="/oren/images/resources/vide8.png" alt="">
												<span class="vid-time">29:32</span>
												<span class="watch_later">
													<i class="icon-watch_later_fill"></i>
												</span>
											</a>	
										</div><!--vid_thumbnail end-->
										<div class="video_info">
											<h3><a href="single_video_page.html" title="">How the Universe Works - The Milky Way Galaxy - Space</a></h3>
											<h4><a href="Single_Channel_Home.html" title="">Loskes</a></h4>
											<span>408K views .<small class="posted_dt">19 hours ago</small></span>
										</div>
									</div><!--videoo end-->
								</div>
							</div>
						</div><!--vidz_list end-->
					</div><!--vidz_videos end-->
				</div>
			</div><!--vidz-row end-->
		</section><!--vds-main end-->

	</div><!--wrapper end-->

</body>
</html>

<script type='text/javascript'>
$(document).ready(function() {
	$.ajax('/oren/video/get_video_batch', {
        dataType: 'json',
        type: 'POST',
		data:{
			page:0,
			per_page:6,	
		},
        success: function (data,status,xhr) {   // success callback function
			console.log(data);
			let video_items = '';
			if (Array.isArray(data.videos))
			{
				data.videos.map(item => {
				video_items += '<div class="col-lg-3 col-md-6 col-sm-6 col-6 full_wdth">'+
									'<div class="videoo">' +
										'<div class="vid_thumbainl">' +
											'<a href="/oren/video/video_details/' + item.id + '" title="">' +
												'<video width="263" height="164"><source src="' + item.url + '"/></video>' +
											'</a>'	+
										'</div>' +
											'<div class="video_info">' +
												'<h3><a href="/oren/video/video_details/' + item.id + '" title="">' + item.title + '</a></h3>' +
												'<h4><a href="" title="">Loskes</a></h4>' +
												'<span>' + item.views + ' views.<small class="posted_dt">' + item.create_time + '</small></span>' +
										'</div>' +
									'</div>' +
								'</div>';
				});
				$('.row').append(video_items);
			}
        },
        error: function (jqXhr, textStatus, errorMessage) { // error callback 
            console.log('get video failure!');
        }
    });
});
let page=1;
$(window).scroll(function() {
	var scrollHeight = $(document).height();
	var scrollPosition = $(window).height() + $(window).scrollTop();
	// console.log(Math.abs((scrollHeight - scrollPosition) / scrollHeight));
	if($(window).scrollTop() + $(window).height() >= $(document).height()) {
		console.log('bottom', page);
		$.ajax('/oren/video/get_video_batch', {
			dataType: 'json',
			type: 'POST',
			data:{
				page:page,
				per_page:6,	
			},
			success: function (data,status,xhr) {   // success callback function
				// bug here! what ifhaving dozens of types?
				console.log(data);
				let video_items = '';
				if (Array.isArray(data.videos))
				{
					data.videos.map(item => {
					video_items += '<div class="col-lg-3 col-md-6 col-sm-6 col-6 full_wdth">'+
										'<div class="videoo">' +
											'<div class="vid_thumbainl">' +
												'<a href="/oren/video/video_details/' + item.id + '" title="">' +
													'<video width="263" height="164"><source src="' + item.url + '"/></video>' +
												'</a>'	+
											'</div>' +
												'<div class="video_info">' +
													'<h3><a href="/oren/video/video_details/' + item.id + '" title="">' + item.title + '</a></h3>' +
													'<h4><a href="" title="">Loskes</a></h4>' +
													'<span>' + item.views + 'views.<small class="posted_dt">' + item.create_time + '</small></span>' +
											'</div>' +
										'</div>' +
									'</div>';
					});
					$('.row').append(video_items);
				}
			},
			error: function (jqXhr, textStatus, errorMessage) { // error callback 
				console.log('get video failure!');
			}
   		});
    }
	page += 1;
});
</script>
